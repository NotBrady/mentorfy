{"id":"mentorfy-3p0","title":"Set up agent architecture","description":"Create src/agents with: types.ts (AgentConfig, ToolConfig, ToolContext), registry.ts (getAgent, listAgents), and rafael/chat.ts with the chat agent config. Keep it minimal - just a map and typed configs.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T08:44:35.725657909Z","created_by":"eli","updated_at":"2026-01-02T08:53:23.406446021Z","deleted_at":"2026-01-02T08:53:23.406446021Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mentorfy-5fz","title":"Phase 1.2: Verify apps work","description":"Test web (pnpm install \u0026\u0026 pnpm build) and API (uv sync \u0026\u0026 uv run python start_server.py) to confirm they run in new locations","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-01T17:02:51.316948-08:00","created_by":"elijah","updated_at":"2026-01-01T17:03:27.543601-08:00","deleted_at":"2026-01-01T17:03:27.543601-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mentorfy-5lp","title":"E2E flow verification","description":"Verify the complete user flow works end-to-end before going live.\n\nTest flow:\n1. POST /api/session → get sessionId\n2. PATCH /api/session/[id] with name, email, context answers\n3. POST /api/chat with a question → verify streaming response includes context\n4. POST /api/generate/diagnosis → verify output references user's answers\n5. Check Langfuse dashboard → verify traces captured with costs\n\nSuccess criteria:\n- [ ] Anonymous user can complete full flow with real AI responses\n- [ ] Context persists across chat messages\n- [ ] Langfuse shows traces with token counts and latency\n- [ ] Response latency \u003c 3s for first token\n- [ ] Rate limiting returns 429 when exceeded\n\nDepends on: mentorfy-j52, mentorfy-fe8, mentorfy-fxe","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T08:58:26.725621262Z","created_by":"eli","updated_at":"2026-01-02T08:59:10.535159303Z","deleted_at":"2026-01-02T08:59:10.535159303Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mentorfy-744","title":"Set up environment variables","description":"Block: Must complete before any other backend work.\n\n1. Create .env.local with all required keys:\n   - SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY\n   - SUPERMEMORY_API_KEY\n   - ANTHROPIC_API_KEY\n   - LANGFUSE_PUBLIC_KEY, LANGFUSE_SECRET_KEY, LANGFUSE_HOST\n   - (Clerk already configured)\n\n2. Verify each connection:\n   - Supabase: test query\n   - Supermemory: test write/search\n   - Anthropic: test completion\n   - Langfuse: test trace\n\n3. Add .env.example with placeholder values for team reference","status":"tombstone","priority":0,"issue_type":"task","created_at":"2026-01-02T08:57:24.800707334Z","created_by":"eli","updated_at":"2026-01-02T08:59:10.513570211Z","deleted_at":"2026-01-02T08:59:10.513570211Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mentorfy-bq7","title":"Wire up Langfuse tracing","description":"Create lib/langfuse.ts client wrapper. Add tracing to /api/chat and /api/generate/[type] - capture inputs, outputs, token usage, latency, session ID for correlation. Set up LANGFUSE_* env vars.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T08:44:36.924243733Z","created_by":"eli","updated_at":"2026-01-02T08:53:23.426636293Z","deleted_at":"2026-01-02T08:53:23.426636293Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mentorfy-iep","title":"Phase 2.3: Wire rafael-ai to real APIs","description":"Replace mock/stub code: use Clerk useUser() for auth, point to real streaming endpoint, use Supabase patterns from existing app. Delete src/lib/api.ts mocks.","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-01T17:03:04.54149-08:00","created_by":"elijah","updated_at":"2026-01-01T17:07:18.586076-08:00","deleted_at":"2026-01-01T17:07:18.586076-08:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mentorfy-umc","title":"test sync","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T22:13:22.1388135Z","created_by":"eli","updated_at":"2026-01-02T22:13:54.088795863Z","close_reason":"test issue - deleting","deleted_at":"2026-01-02T22:13:54.088795863Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mt-03m","title":"Handle returning user flow","description":"Implement UI flow when backend detects a returning user.\n\n**Current state:**\n- Backend PATCH returns `{ returning: true, existingSessionId }` when email matches existing session\n- Frontend doesn't handle this response\n\n**Changes needed:**\n1. After contact form submission, check for `returning: true` in response\n2. If returning user detected:\n   - Option A: Show \"Welcome back!\" message and continue with existing session\n   - Option B: Ask user if they want to continue previous session or start fresh\n3. If continuing existing session:\n   - Fetch existing session data with `GET /api/session/[existingSessionId]`\n   - Hydrate UserContext with existing context\n   - Resume from where they left off\n\n**Backend endpoints:**\n- `PATCH /api/session/[id]` - returns returning user flag\n- `GET /api/session/[id]` - fetches full session including context\n\n**Files to modify:**\n- Contact form submission handler\n- UserContext (to support hydration from backend)\n\n**Depends on:** mentorfy-64p (contact sync)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T21:09:37.994666512Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.718612818Z","closed_at":"2026-01-02T22:40:07.023861903Z","close_reason":"Implemented returning user flow with welcome back UI"}
{"id":"mt-06l","title":"Phase 3: Wire up app routes + API route","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:12:27.924295-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.763365126Z","closed_at":"2025-12-29T22:56:50.347608-08:00","close_reason":"Closed","dependencies":[{"issue_id":"mt-06l","depends_on_id":"mt-nv0","type":"blocks","created_at":"2025-12-29T22:12:38.986149-08:00","created_by":"daemon"}]}
{"id":"mt-0zi","title":"Consider Clerk afterSignInUrl for auth gate pending actions","description":"Current auth gate uses ref-based pending action storage. Works well but doesn't survive page refresh. Could use Clerk's afterSignInUrl callback for URL-based flow if this becomes a problem. Low priority - current approach is simpler and works for most cases.","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-04T04:02:26.699326384Z","created_by":"eli","updated_at":"2026-01-04T07:00:45.980667622Z","closed_at":"2026-01-04T07:00:45.980667622Z","close_reason":"Closed","dependencies":[{"issue_id":"mt-0zi","depends_on_id":"mt-9np","type":"blocks","created_at":"2026-01-04T06:49:24.370346164Z","created_by":"eli"}]}
{"id":"mt-2m3","title":"Phase 3.2: Add root-level dev files","description":"Create Makefile with install/dev/web/api targets. Optionally add docker-compose.yml for local Redis/Neo4j.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T17:03:14.258259-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.847697581Z","closed_at":"2026-01-01T17:36:54.25378-08:00","close_reason":"Closed"}
{"id":"mt-3nm","title":"Make header account button open sign-in modal","description":"In src/app/rafael-ai/page.tsx, update the SignedOut section (around line 322-345):\n\n- Add useClerk import and destructure openSignIn\n- Add onClick={() =\u003e openSignIn({})} to the button\n- Remove opacity: 0.35 (button should look active)\n- Change cursor: 'default' to cursor: 'pointer'\n\nThis is independent UI work - no dependencies on other auth issues.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T04:57:08.860879404Z","created_by":"eli","updated_at":"2026-01-04T07:06:48.530720281Z","closed_at":"2026-01-04T07:06:48.530720281Z","close_reason":"Closed","labels":["auth","ui"]}
{"id":"mt-3p0","title":"Set up agent architecture","description":"Create src/agents with: types.ts (AgentConfig, ToolConfig, ToolContext), registry.ts (getAgent, listAgents), and rafael/chat.ts with the chat agent config. Keep it minimal - just a map and typed configs.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T08:44:35.725657909Z","created_by":"eli","updated_at":"2026-01-02T08:53:23.406446021Z","deleted_at":"2026-01-02T08:53:23.406446021Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mt-5lp","title":"E2E flow verification","description":"Verify the complete user flow works end-to-end before going live.\n\nTest flow:\n1. POST /api/session → get sessionId\n2. PATCH /api/session/[id] with name, email, context answers\n3. POST /api/chat with a question → verify streaming response includes context\n4. POST /api/generate/diagnosis → verify output references user's answers\n5. Check Langfuse dashboard → verify traces captured with costs\n\nSuccess criteria:\n- [ ] Anonymous user can complete full flow with real AI responses\n- [ ] Context persists across chat messages\n- [ ] Langfuse shows traces with token counts and latency\n- [ ] Response latency \u003c 3s for first token\n- [ ] Rate limiting returns 429 when exceeded\n\nDepends on: mt-j52, mt-fe8, mt-fxe","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T08:58:26.725621262Z","created_by":"eli","updated_at":"2026-01-02T08:59:10.535159303Z","deleted_at":"2026-01-02T08:59:10.535159303Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mt-5yl","title":"Wire diagnosis generation to backend","description":"Call /api/generate/diagnosis at AI moment steps in phase flow.\n\n**Current state:**\n- PhaseFlow has `AIMomentStep` type in step definitions\n- Currently shows mock or placeholder content\n\n**Implementation:**\n1. When `AIMomentStep` reached, call:\n```typescript\nconst res = await fetch('/api/generate/diagnosis', {\n  method: 'POST',\n  body: JSON.stringify({ sessionId })\n})\nconst { content } = await res.json()\n```\n\n2. Display `content` in AI moment UI\n3. Handle loading state (~2-3 seconds generation time)\n4. Handle errors gracefully\n\n**Backend returns structured analysis:**\n- Current Position\n- Key Blockers (2-3 issues)\n- Quick Wins (immediate actions)\n- Growth Path (next milestone)\n\n**Rate limits:** 3/min anon, 10/min authenticated\n\n**Files to modify:**\n- Wherever `AIMomentStep` rendering happens (likely PhaseFlow.tsx)\n\n**Depends on:** mentorfy-yfp (session init)\n\n**Note:** Works better with context synced (mentorfy-ldg), but not strictly required - backend reads whatever context exists in session.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T21:09:48.864429075Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.712383687Z","closed_at":"2026-01-02T21:46:30.769537847Z","close_reason":"Already implemented in commit 887018a - useAgent.getResponse calls /api/generate/diagnosis for AI moments"}
{"id":"mt-64p","title":"Sync contact info to backend session","description":"CLOSED: Consolidated into mentorfy-ldg (sync UserContext to backend).\n\nThe contact info sync and context sync are the same PATCH call to /api/session/[id]. No need for separate issues.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-02T21:09:10.336310505Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.664630961Z","closed_at":"2026-01-02T21:14:00.467787562Z"}
{"id":"mt-6fs","title":"Langfuse traces not appearing","description":"Langfuse dashboard shows no traces despite code being wired up.\n\n**Observed:**\n- E2E curl tests passed (chat, diagnosis work)\n- But no traces visible in Langfuse dashboard\n\n**To investigate:**\n1. Verify LANGFUSE_* env vars are set correctly in .env.local\n2. Check if Langfuse client is initialized (lib/langfuse.ts)\n3. Verify traces are being created and flushed\n4. Check Langfuse dashboard is pointing to correct project\n5. Look for errors in server logs during API calls\n\n**Files:**\n- src/lib/langfuse.ts\n- src/app/api/chat/route.ts\n- src/app/api/generate/[type]/route.ts","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-02T21:47:46.023286893Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.648516592Z","closed_at":"2026-01-02T21:54:06.193707167Z","close_reason":"Fixed: env var mismatch (LANGFUSE_BASE_URL vs LANGFUSE_HOST) + added flushLangfuse() calls"}
{"id":"mt-6yn","title":"Delete mock/stub files after integration","description":"Clean up placeholder files after real integrations are verified working.\n\n**Files to delete:**\n- `src/data/rafael-ai/mockResponses.ts` - entire file\n- `src/lib/api.ts` - delete stub `sendMessage()` or whole file\n\n**Also clean up:**\n- Remove artificial `setTimeout` delays in useAgent\n- Remove `console.warn` for missing mock responses\n- Remove any `// TODO: integrate with real API` comments\n\n**Do this after:** mentorfy-88s (E2E verification) passes\n\n**Depends on:** mentorfy-p82 (chat wiring), mentorfy-88s (E2E verification)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T21:10:48.006590248Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.701783418Z","closed_at":"2026-01-02T21:38:03.617304325Z","close_reason":"Implemented in commit 887018a"}
{"id":"mt-744","title":"Set up environment variables","description":"Block: Must complete before any other backend work.\n\n1. Create .env.local with all required keys:\n   - SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY\n   - SUPERMEMORY_API_KEY\n   - ANTHROPIC_API_KEY\n   - LANGFUSE_PUBLIC_KEY, LANGFUSE_SECRET_KEY, LANGFUSE_HOST\n   - (Clerk already configured)\n\n2. Verify each connection:\n   - Supabase: test query\n   - Supermemory: test write/search\n   - Anthropic: test completion\n   - Langfuse: test trace\n\n3. Add .env.example with placeholder values for team reference","status":"tombstone","priority":0,"issue_type":"task","created_at":"2026-01-02T08:57:24.800707334Z","created_by":"eli","updated_at":"2026-01-02T08:59:10.513570211Z","deleted_at":"2026-01-02T08:59:10.513570211Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mt-7d0","title":"Delete old Vite code","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T22:12:28.195161-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.855561321Z","closed_at":"2025-12-29T23:08:46.102061-08:00","close_reason":"Closed","dependencies":[{"issue_id":"mt-7d0","depends_on_id":"mt-06l","type":"blocks","created_at":"2025-12-29T22:12:39.217118-08:00","created_by":"daemon"}]}
{"id":"mt-7kw","title":"Voice recording feature (deferred)","description":"Voice recording and transcription feature.\n\n**Reference implementation:** mentorfy-frontend repo\n\n**Tech stack:**\n- Browser native APIs (MediaRecorder, getUserMedia) - no external audio libs\n- Groq Whisper API (`whisper-large-v3` model) for transcription\n- Audio format: WebM\n\n**Flow:**\n1. User clicks mic → getUserMedia({ audio: true })\n2. MediaRecorder captures audio chunks\n3. On stop → Blob sent to /api/transcribe\n4. Backend calls Groq Whisper API\n5. Transcribed text returned to frontend\n\n**Environment:**\n- `GROQ_API_KEY` - required for Whisper API\n\n**UI:** Brady's domain (not in scope here)\n\n**Files:**\n- `src/app/api/transcribe/route.ts` - new endpoint","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-02T21:10:28.166829727Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.869740651Z","closed_at":"2026-01-03T00:23:06.784937097Z","close_reason":"Closed"}
{"id":"mt-7kw.1","title":"Create /api/transcribe endpoint","description":"Create POST endpoint for audio transcription.\n\n**Endpoint:** POST /api/transcribe\n\n**Request:**\n- Content-Type: multipart/form-data\n- Body: audio file (webm, mp3, wav, m4a)\n\n**Response:**\n```json\n{ \"success\": true, \"transcription\": \"text here\" }\n```\n\n**Implementation:**\n1. Accept multipart/form-data with audio file\n2. Validate GROQ_API_KEY exists\n3. Forward to Groq API:\n   - URL: https://api.groq.com/openai/v1/audio/transcriptions\n   - Model: whisper-large-v3\n   - Response format: json\n4. Return transcription text\n\n**Reference:** mentorfy-frontend/app/api/transcribe/route.ts\n\n**File:** src/app/api/transcribe/route.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T00:13:47.629817998Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.863726484Z","closed_at":"2026-01-03T00:22:14.319208603Z","close_reason":"Closed","dependencies":[{"issue_id":"mt-7kw.1","depends_on_id":"mt-7kw","type":"parent-child","created_at":"2026-01-03T00:13:47.632264073Z","created_by":"eli"},{"issue_id":"mt-7kw.1","depends_on_id":"mt-7kw.2","type":"blocks","created_at":"2026-01-03T00:14:15.969719684Z","created_by":"eli"}]}
{"id":"mt-7kw.2","title":"Add GROQ_API_KEY to environment","description":"Add Groq API key for Whisper transcription.\n\n**Steps:**\n1. Add GROQ_API_KEY to .env.example\n2. Add to Vercel/deployment environment\n3. Document in README if needed\n\n**Get key from:** https://console.groq.com/keys","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T00:13:53.414893508Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.859883Z","closed_at":"2026-01-03T00:20:13.85894231Z","close_reason":"Closed","dependencies":[{"issue_id":"mt-7kw.2","depends_on_id":"mt-7kw","type":"parent-child","created_at":"2026-01-03T00:13:53.424393068Z","created_by":"eli"}]}
{"id":"mt-7kw.3","title":"Wire ChatBar recording to /api/transcribe","description":"Connect existing mic button to transcription endpoint.\n\n**Current state:** ChatBar.tsx has mic button with startRecording handler but no actual implementation.\n\n**Implementation (in ChatBar.tsx):**\n1. Add state: isRecording, isTranscribing, mediaRecorderRef, audioChunksRef\n2. startRecording():\n   - getUserMedia({ audio: true })\n   - Create MediaRecorder with webm format\n   - Collect chunks on dataavailable\n3. stopRecording():\n   - Stop MediaRecorder\n   - Create Blob from chunks\n   - Call transcribeAudio()\n4. transcribeAudio(blob):\n   - POST to /api/transcribe with FormData\n   - On success: insert text into input field\n   - Handle errors gracefully\n\n**Reference:** mentorfy-frontend/components/mentor-prompt-box.tsx lines 316-407\n\n**File:** src/components/rafael-ai/shared/ChatBar.tsx","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-03T00:14:03.531664917Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.857045911Z","closed_at":"2026-01-03T00:23:06.737224128Z","close_reason":"Closed","dependencies":[{"issue_id":"mt-7kw.3","depends_on_id":"mt-7kw","type":"parent-child","created_at":"2026-01-03T00:14:03.542023744Z","created_by":"eli"},{"issue_id":"mt-7kw.3","depends_on_id":"mt-7kw.1","type":"blocks","created_at":"2026-01-03T00:14:15.936200128Z","created_by":"eli"}]}
{"id":"mt-88s","title":"E2E integration verification","description":"Verify the complete frontend-to-backend flow works before shipping.\n\n**Test sequence:**\n1. Load app fresh (clear localStorage)\n2. Verify session created (check Network tab)\n3. Complete phase 1 form\n4. Verify PATCH sent with context (check Network tab)\n5. Enter chat, send a message\n6. Verify streaming response from Claude (not mock)\n7. Check Langfuse dashboard for trace\n8. Refresh page\n9. Verify session restored (not creating new)\n10. Verify chat history preserved\n\n**Success criteria:**\n- [ ] No mock responses anywhere in flow\n- [ ] Session persists across refresh\n- [ ] Context appears in Claude's responses\n- [ ] Langfuse shows traces with token counts\n- [ ] Rate limiting works (send 6 messages fast, see 429)\n\n**Do this after:** All P0 issues complete\n\n**Files:** None - this is manual testing","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-02T21:14:22.279232843Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.656424636Z","closed_at":"2026-01-02T21:45:19.944234325Z","close_reason":"E2E verified via curl: session CRUD, chat streaming with context, rate limiting (429 on 6th), diagnosis gen all working. Langfuse needs manual dashboard check."}
{"id":"mt-8g0","title":"Race condition: no unique constraint on (email, clerk_org_id) in sessions table","description":"When checking for returning users in PATCH /api/session/[id], the code searches for existing sessions by email without a unique constraint. If two requests arrive simultaneously with the same email, both could pass this check before either commits, creating duplicate sessions.\n\nFix: Add unique constraint:\nALTER TABLE sessions ADD CONSTRAINT sessions_email_org_unique UNIQUE (email, clerk_org_id);\n\nFound during auth gate planning review.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T02:48:31.779040233Z","created_by":"eli","updated_at":"2026-01-04T06:52:02.514253571Z","closed_at":"2026-01-04T06:52:02.514253571Z","close_reason":"Closed"}
{"id":"mt-9h2","title":"Phase 1.1: Move production apps into monorepo","description":"Create apps directory and rsync frontend + API repos into apps/web and apps/api (excluding .git, node_modules, .next, __pycache__, .venv, .ruff_cache)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T17:03:32.956672-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.74786655Z","closed_at":"2026-01-01T17:38:35.389863-08:00","close_reason":"Closed"}
{"id":"mt-9jm","title":"Implement session API endpoints","description":"Build session API endpoints (JSONB only - Supermemory writes happen in chat endpoint, not here).\n\n1. POST /api/session - create session, generate supermemory_container name\n2. PATCH /api/session/[id] - update contact info, deep merge context into JSONB\n3. POST /api/session/[id]/link - set clerk_user_id on session\n\nReturning user detection: if email matches existing session for same org, return that session ID.\n\nWhy no Supermemory here: Simpler. Context only needs to be in Supermemory when chat is called. Writing on every session update adds latency for no immediate value.\n\nDepends on: mentorfy-x9b (env), mentorfy-b7h (sessions table)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T08:44:34.971310471Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.738547184Z","closed_at":"2026-01-02T09:52:36.122106538Z"}
{"id":"mt-9np","title":"Create useAuthGate hook","description":"Create src/hooks/useAuthGate.ts - a hook that gates phase transitions behind authentication.\n\nFeatures:\n- Stores pending action when auth modal opens\n- Detects sign-in completion via isSignedIn state change\n- Calls /api/session/[id]/link to link session after sign-in\n- Executes stored pending action after successful sign-in\n- Exposes gatePhaseTransition(completedPhase, onAllowed) function\n\nDepends on: AUTH_CONFIG being added to rafael-ai.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T04:56:59.177729039Z","created_by":"eli","updated_at":"2026-01-04T06:58:41.239296999Z","closed_at":"2026-01-04T06:58:41.239296999Z","close_reason":"Closed","labels":["auth","hook"],"dependencies":[{"issue_id":"mt-9np","depends_on_id":"mt-zqe","type":"blocks","created_at":"2026-01-04T04:57:45.190221129Z","created_by":"eli"}]}
{"id":"mt-apx","title":"Update session link endpoint for Clerk integration","description":"Update src/app/api/session/[id]/link/route.ts to:\n\n1. Get authenticated Clerk user ID from server-side auth() (don't trust client)\n2. Update session record with clerk_user_id\n3. Add user to the organization via clerkClient().organizations.createOrganizationMembership()\n4. Handle 'already_a_member_in_organization' errors gracefully\n\nThis is backend-only work, no frontend dependencies.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T04:56:59.782802429Z","created_by":"eli","updated_at":"2026-01-04T07:03:41.90997973Z","closed_at":"2026-01-04T07:03:41.90997973Z","close_reason":"Closed","labels":["api","auth"]}
{"id":"mt-awj","title":"Phase 2: Port layout components (2 files)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:12:27.407757-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.771545082Z","closed_at":"2025-12-29T22:31:27.593975-08:00","close_reason":"Closed","dependencies":[{"issue_id":"mt-awj","depends_on_id":"mt-i8p","type":"blocks","created_at":"2025-12-29T22:12:38.527386-08:00","created_by":"daemon"}]}
{"id":"mt-b7h","title":"Create Supabase sessions table","description":"Set up Supabase client and create sessions table.\n\n1. Create lib/db.ts with Supabase client using service role key\n2. Create sessions table with: id, clerk_user_id, clerk_org_id, email, phone, name, supermemory_container, status, context JSONB, timestamps\n3. Add indexes for email+org, clerk_user_id, and status\n4. Verify with a test query\n\nPARALLEL: Can be done simultaneously with mentorfy-p94 (Supermemory wrapper) - no dependencies between them.\n\nDepends on: mentorfy-x9b (env setup)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T08:44:34.680760532Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.74354152Z","closed_at":"2026-01-02T09:52:29.189571249Z"}
{"id":"mt-bq7","title":"Wire up Langfuse tracing","description":"Create lib/langfuse.ts client wrapper. Add tracing to /api/chat and /api/generate/[type] - capture inputs, outputs, token usage, latency, session ID for correlation. Set up LANGFUSE_* env vars.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T08:44:36.924243733Z","created_by":"eli","updated_at":"2026-01-02T08:53:23.426636293Z","deleted_at":"2026-01-02T08:53:23.426636293Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mt-c5q","title":"Phase 0: Next.js scaffold + deps","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:12:26.619974-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.785372645Z","closed_at":"2025-12-29T22:20:05.300384-08:00","close_reason":"Closed"}
{"id":"mt-cdr","title":"Phase 1: Foundation files (CSS, data, context, hooks, lib)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:12:26.897566-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.781682139Z","closed_at":"2025-12-29T22:24:02.700204-08:00","close_reason":"Closed","dependencies":[{"issue_id":"mt-cdr","depends_on_id":"mt-c5q","type":"blocks","created_at":"2025-12-29T22:12:38.067809-08:00","created_by":"daemon"}]}
{"id":"mt-d51","title":"Integrate auth gate into phase transitions","description":"In src/app/rafael-ai/page.tsx:\n\n1. Import useAuthGate hook\n2. Call useAuthGate() to get gatePhaseTransition\n3. Wrap handleInitialLevelComplete logic in gatePhaseTransition(currentPhaseNumber, () =\u003e { ... })\n4. Wrap handlePanelLevelComplete logic in gatePhaseTransition(currentPhaseNumber, () =\u003e { ... })\n\nThis ensures users must sign in after completing the configured phase before proceeding.\n\nDepends on: useAuthGate hook being created","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T04:57:00.641932356Z","created_by":"eli","updated_at":"2026-01-04T07:00:14.136430956Z","closed_at":"2026-01-04T07:00:14.136430956Z","close_reason":"Closed","labels":["auth","integration"],"dependencies":[{"issue_id":"mt-d51","depends_on_id":"mt-9np","type":"blocks","created_at":"2026-01-04T04:57:45.458210725Z","created_by":"eli"}]}
{"id":"mt-dlo","title":"Update Clerk org ID from slug to actual ID","description":"In src/context/UserContext.tsx, change CLERK_ORG_ID from 'rafael-tatts' (slug) to 'org_35wDDMLUgC1nZZLkDLtZ3A8TbJY' (actual Clerk org ID). This avoids slug resolution and matches what's stored in the sessions table.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T04:56:36.622356666Z","created_by":"eli","updated_at":"2026-01-04T06:54:35.411144262Z","closed_at":"2026-01-04T06:54:35.411144262Z","close_reason":"Closed","labels":["auth","config"]}
{"id":"mt-dra","title":"E2E backend verification","description":"Before frontend handoff, verify full flow works:\n\n1. Create session (curl POST /api/session)\n2. Update session with context (curl PATCH /api/session/[id])\n3. Chat with Rafael, verify context retrieval (curl POST /api/chat)\n4. Generate diagnosis (curl POST /api/generate/diagnosis)\n5. Verify Langfuse traces appear\n6. Verify Supermemory memories exist\n\nDocument curl commands for frontend team.\n\nDepends on: all implementation issues","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T08:52:59.568862566Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.729338266Z","closed_at":"2026-01-02T09:52:51.474338803Z"}
{"id":"mt-fe8","title":"Implement generation agents and endpoint","description":"Build generation endpoints for diagnosis and summary.\n\n1. Create src/agents/rafael/diagnosis.ts agent config\n2. Create src/agents/rafael/summary.ts agent config  \n3. Implement POST /api/generate/[type] endpoint\n4. Read context from session JSONB (not Supermemory - needs instant data)\n5. Add Langfuse tracing (reuse lib/langfuse.ts from chat issue)\n6. Test: generate diagnosis and summary, verify traces\n\nDepends on: mentorfy-x9b (env), mentorfy-b7h (sessions table), mentorfy-9jm (session endpoints), mentorfy-j52 (agent architecture + Langfuse setup)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T08:44:36.478033107Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.83254766Z","closed_at":"2026-01-02T09:52:36.168604951Z"}
{"id":"mt-fqz","title":"Phase 2.2: Fix imports in copied files","description":"Rename context files if they conflict with existing ones. Run pnpm build to catch any issues.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T17:03:04.303608-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.752228126Z","closed_at":"2026-01-01T17:32:38.245597-08:00","close_reason":"Closed"}
{"id":"mt-fxe","title":"Add Upstash rate limiting","description":"Ship WITH MVP, not after. Cost risk is real - unprotected LLM endpoints can burn $200+ from 10K malicious requests.\n\nImplementation (~20 lines):\n1. pnpm add @upstash/ratelimit @upstash/redis\n2. Create lib/ratelimit.ts with Upstash client\n3. Add middleware to /api/chat: 5/min anon, 20/min authenticated\n4. Add middleware to /api/generate: 3/min anon, 10/min authenticated\n5. Identifier: Clerk user ID if auth'd, else IP\n6. Return 429 with Retry-After header when limited\n\nEnv vars: UPSTASH_REDIS_REST_URL, UPSTASH_REDIS_REST_TOKEN\n\nSee docs/SECURITY_RATE_LIMITING_PLAN.md for full context.\n\nDepends on: mentorfy-j52 (chat endpoint), mentorfy-fe8 (generate endpoint)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T08:44:37.320794592Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.732230045Z","closed_at":"2026-01-02T09:52:36.190177617Z"}
{"id":"mt-i8p","title":"Phase 2: Port shared components (14 files)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:12:27.152224-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.777829248Z","closed_at":"2025-12-29T22:30:49.881672-08:00","close_reason":"Closed","dependencies":[{"issue_id":"mt-i8p","depends_on_id":"mt-cdr","type":"blocks","created_at":"2025-12-29T22:12:38.297869-08:00","created_by":"daemon"}]}
{"id":"mt-j52","title":"Implement /api/chat endpoint","description":"Build the complete chat flow including agent architecture and observability.\n\n1. Create src/agents/types.ts (AgentConfig, ToolConfig, ToolContext)\n2. Create src/agents/registry.ts (getAgent, listAgents)\n3. Create src/agents/rafael/chat.ts - extend existing src/lib/api.ts prompt\n4. Create lib/langfuse.ts client wrapper\n5. Implement POST /api/chat with SSE streaming (Vercel AI SDK)\n6. Flow: fetch session → search Supermemory → load agent → call Claude → stream response\n7. On first chat: write session context to Supermemory (fire-and-forget)\n8. After each turn: write conversation to Supermemory (fire-and-forget)\n9. Add Langfuse tracing to capture inputs, outputs, tokens, latency\n\nDepends on: mentorfy-x9b (env), mentorfy-b7h (sessions table), mentorfy-9jm (session endpoints), mentorfy-p94 (Supermemory wrapper)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T08:44:36.066351604Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.736787806Z","closed_at":"2026-01-02T09:52:36.145811032Z"}
{"id":"mt-k5u","title":"Phase 3.3: Consolidate config","description":"Merge or organize .env.example files. Update root .gitignore to include apps/*/node_modules, apps/*/.next, etc.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T17:03:14.504934-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.844715342Z","closed_at":"2026-01-01T17:38:20.881291-08:00","close_reason":"Closed"}
{"id":"mt-ldg","title":"Sync UserContext state to backend session","description":"Sync UserContext state to backend session on phase completion.\n\n**Consolidates:** This issue covers both context sync AND contact info sync (mentorfy-64p closed as duplicate).\n\n**Current state:**\n- UserContext stores all data in localStorage only\n- Backend session never updated after creation\n- Data lost if user switches device\n\n**Gap found:** UserContext has `user.name` and `user.phone` but NOT `user.email`. The form collects email (phases.ts:54) but it's stored elsewhere or lost. Need to add `email` to user state.\n\n**Implementation:**\n1. Add `email` field to UserContext `user` object\n2. Add `syncToBackend()` function:\n```typescript\nasync function syncToBackend() {\n  await fetch(`/api/session/${sessionId}`, {\n    method: 'PATCH',\n    body: JSON.stringify({\n      name: state.user.name,\n      email: state.user.email,\n      phone: state.user.phone,\n      context: {\n        situation: state.situation,\n        phase2: state.phase2,\n        phase3: state.phase3,\n        phase4: state.phase4,\n        progress: state.progress,\n      }\n    })\n  })\n}\n```\n\n3. Call sync at these points:\n   - After contact info form submitted\n   - After each phase completed\n   - Debounce to avoid excessive calls (300ms)\n\n4. Handle returning user response:\n   - If PATCH returns `{ returning: true, existingSessionId }`\n   - Trigger returning user flow (separate issue mentorfy-03m)\n\n**Files to modify:**\n- `src/context/UserContext.tsx` - add email field, add sync function\n- Phase completion handlers - call sync\n\n**Depends on:** mentorfy-yfp (session init)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-02T21:09:01.536420579Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.671856408Z","closed_at":"2026-01-02T21:38:02.796765524Z","close_reason":"Implemented in commit 887018a"}
{"id":"mt-mv6","title":"Remove DEMO_COMMANDS from chat","description":"Delete hardcoded demo command triggers from production chat.\n\n**Current state:**\n- `src/components/rafael-ai/screens/AIChat.tsx` lines 541-594\n- Three magic strings trigger hardcoded responses:\n  - `\"sell me\"` → checkout embed with hardcoded plan ID\n  - `\"video\"` → video embed with hardcoded URL\n  - `\"book me\"` → Calendly embed with hardcoded URL\n\n**Changes needed:**\n1. Delete the `DEMO_COMMANDS` object entirely (~50 lines)\n2. Remove the demo command check logic that uses it\n3. Let all messages flow through normal AI chat path\n\n**Alternative:** If these embeds should be AI-triggered, that's a separate feature. For now, just remove the hardcoded demo triggers.\n\n**Files to modify:**\n- `src/components/rafael-ai/screens/AIChat.tsx`","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T21:09:28.923890145Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.722787249Z","closed_at":"2026-01-02T21:38:03.230672284Z","close_reason":"Implemented in commit 887018a"}
{"id":"mt-nbp","title":"Update video URLs in mentor config","description":"Replace placeholder video URLs with actual unique videos per phase.\n\n**Current state:**\n- `src/data/rafael-ai/mentor.ts` line 1: single `VIDEO_URL` constant\n- Lines 17-63: All 9 video entries reference same URL `4i06zkj7fg`\n- Users see same video for every phase\n\n**Changes needed:**\n1. Get actual Wistia video IDs for each phase from Rafael/content team\n2. Update each video entry in `mentor.ts` with correct URL:\n   - welcome video\n   - phase 1-4 intro videos\n   - phase 1-4 completion videos\n\n**This is a content task, not a code task.** No backend changes needed.\n\n**Files to modify:**\n- `src/data/rafael-ai/mentor.ts`\n\n**Blocked by:** Need actual video content/URLs from stakeholder","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T21:09:19.045485171Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.726664645Z","closed_at":"2026-01-02T21:56:39.694882371Z","close_reason":"Blocked on content - need actual Wistia video IDs from Rafael. Reopen when content arrives."}
{"id":"mt-nj2","title":"Update deployment configs","description":"Vercel: set root directory to apps/web. Railway: set root directory to apps/api.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T17:03:18.649302-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.839129289Z","closed_at":"2026-01-01T17:38:26.025989-08:00","close_reason":"Closed"}
{"id":"mt-nv0","title":"Phase 2: Port screen components (7 files)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T22:12:27.659857-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.767714913Z","closed_at":"2025-12-29T22:52:38.848203-08:00","close_reason":"Closed","dependencies":[{"issue_id":"mt-nv0","depends_on_id":"mt-awj","type":"blocks","created_at":"2025-12-29T22:12:38.758304-08:00","created_by":"daemon"}]}
{"id":"mt-ojx","title":"Implement account button with Clerk","description":"Make the account button functional using Clerk's user management.\n\n**Current state:**\n- `src/app/rafael-ai/page.tsx` lines 309-330\n- Button is visually disabled (`opacity: 0.35`, `cursor: default`)\n- No onClick handler\n\n**Options:**\n1. **Use Clerk's UserButton component** - Drop-in replacement, handles everything\n2. **Custom implementation** - Navigate to Clerk's hosted user portal\n3. **Hide for MVP** - Remove button entirely until post-launch\n\n**Recommended:** Option 1 - Use `\u003cUserButton /\u003e` from `@clerk/nextjs`\n\n**Files to modify:**\n- `src/app/rafael-ai/page.tsx`\n\n**Note:** This only matters for authenticated users. Anonymous users won't have account management.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T21:09:59.133418841Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.829521464Z","closed_at":"2026-01-02T23:08:55.790377213Z","close_reason":"Implemented with ClerkProvider, UserButton, and middleware"}
{"id":"mt-p82","title":"Wire useAgent hook to /api/chat endpoint","description":"Replace mock response system with real streaming API calls.\n\n**Current state:**\n- `src/hooks/useAgent.ts` uses `mockResponses` lookup\n- Interface: `getResponse(promptKey, state, userMessage)`\n- No conversation history tracking\n- No sessionId awareness\n\n**Interface change needed:**\nThe hook signature must change to support the real API:\n```typescript\n// Before\ngetResponse(promptKey: string, state: any, userMessage: string)\n\n// After - option A: minimal change\ngetResponse(sessionId: string, messages: Message[], userMessage: string)\n\n// After - option B: cleaner\nsendMessage(content: string) // hook manages sessionId + history internally\n```\n\n**Implementation:**\n1. Add `sessionId` prop or get from UserContext\n2. Track conversation history as `messages[]` array\n3. Call `POST /api/chat` with `{ sessionId, messages }`\n4. Parse SSE stream using `TextDecoderStream` or similar\n5. Accumulate streamed text and return to caller\n6. On complete, append assistant response to messages history\n\n**Error handling:**\n- 429: Show \"Slow down\" message, disable input briefly\n- 404: Session expired, create new session\n- 500: Show error, allow retry\n\n**Files to modify:**\n- `src/hooks/useAgent.ts` - rewrite\n- `src/components/rafael-ai/screens/AIChat.tsx` - update call sites\n- `src/components/rafael-ai/screens/PhaseFlow.tsx` - update call sites\n\n**Testing:**\n- Send message, verify streaming works\n- Send 6 messages rapidly, verify rate limit handled\n- Refresh page, verify history preserved\n\n**Depends on:** mentorfy-yfp (session init)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-02T21:08:36.83881105Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.687886415Z","closed_at":"2026-01-02T21:38:02.50233315Z","close_reason":"Implemented in commit 887018a"}
{"id":"mt-p94","title":"Implement Supermemory client wrapper","description":"Create lib/supermemory.ts - minimal wrapper for chat context retrieval.\n\nFunctions:\n- searchMemories(containerId: string, query: string): Promise\u003cstring[]\u003e\n  Semantic search for relevant context given user message\n  \n- writeMemory(containerId: string, content: string): Promise\u003cvoid\u003e\n  Fire-and-forget write (don't await in request path)\n  Used by chat endpoint to save: conversation turns + structured context on first chat\n\nContainer naming: {org_id}-{session_uuid}\n\nPARALLEL: Can be done simultaneously with mentorfy-b7h (sessions table) - no dependencies between them.\n\nDepends on: mentorfy-x9b (env setup)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T08:44:35.398636977Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.836533415Z","closed_at":"2026-01-02T09:52:36.093048221Z"}
{"id":"mt-qmd","title":"Phase 2.1: Copy prototype files into web app","description":"Copy rafael-ai route, components, context, hooks, and data files into apps/web (flat structure, no nested rafael-ai subdirs for context/data)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T17:03:04.061513-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.755570449Z","closed_at":"2026-01-01T17:30:00.31638-08:00","close_reason":"Closed"}
{"id":"mt-to2","title":"Link session to authenticated user","description":"Associate anonymous session with Clerk user after authentication.\n\n**Current state:**\n- Sessions are created anonymously (no clerk_user_id)\n- When user authenticates via Clerk, session remains anonymous\n- No link between Clerk user and their session\n\n**Changes needed:**\n1. After successful Clerk authentication, call `POST /api/session/[id]/link`:\n   ```json\n   {\n     \"clerk_user_id\": \"user_...\"\n   }\n   ```\n2. This enables:\n   - Higher rate limits (20/min vs 5/min for chat)\n   - User can resume session from other devices\n   - Analytics tied to actual user\n\n**Backend endpoint:** `POST /api/session/[id]/link` - fully implemented\n\n**Files to modify:**\n- Auth callback handler or Clerk event listener\n\n**Depends on:** mentorfy-yfp (session init)","status":"closed","priority":2,"issue_type":"task","assignee":"eli","created_at":"2026-01-02T21:10:09.998742295Z","created_by":"eli","updated_at":"2026-01-04T06:42:31.051369736Z","closed_at":"2026-01-04T06:42:31.051369736Z","close_reason":"Superseded by mt-apx (backend) + mt-9np (frontend)"}
{"id":"mt-u46","title":"Phase 3.1: Remove prototype source files","description":"Delete src/, next-app/, package.json, pnpm-lock.yaml, tsconfig.json, next.config.ts, postcss.config.mjs, eslint.config.mjs, next-env.d.ts from monorepo root","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-01T17:03:14.017752-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.851823567Z","closed_at":"2026-01-01T17:35:47.146739-08:00","close_reason":"Closed"}
{"id":"mt-umc","title":"test sync","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-02T22:13:22.1388135Z","created_by":"eli","updated_at":"2026-01-02T22:13:54.088795863Z","close_reason":"test issue - deleting","deleted_at":"2026-01-02T22:13:54.088795863Z","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mt-vk9","title":"Browser E2E verification","description":"Verify the complete flow works in an actual browser, not just curl.\n\n**Tests needed:**\n1. Clear localStorage, load app fresh\n2. Verify session created (Network tab)\n3. Complete phase 1 form\n4. Verify PATCH sent with context\n5. Navigate to chat, send message\n6. Verify streaming renders in UI\n7. Refresh page\n8. Verify session restored\n9. Verify chat history preserved\n10. Verify user context preserved\n\n**Why this matters:**\nCurl tests verified API layer, but localStorage hydration and React state need browser testing.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-02T21:47:46.560972972Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.696940149Z","closed_at":"2026-01-02T14:48:47.651032-08:00"}
{"id":"mt-x3c","title":"Define plus icon button feature","description":"The plus icon in ChatBar should allow file uploads.\n\n**Specs:**\n- **File types:** jpg, png, webp, gif, pdf\n- **Max size:** 10MB\n- **Storage:** Supabase Storage bucket `session-uploads/{sessionId}/{filename}`\n\n**Implementation needed:**\n1. Add onClick handler to plus button in `ChatBar.tsx`\n2. Create hidden file input triggered by button click\n3. Create `POST /api/upload` endpoint using Supabase Storage\n4. Display uploaded file preview in chat\n5. Include file reference when sending message to AI\n\n**Files:**\n- `src/components/rafael-ai/shared/ChatBar.tsx` - UI changes\n- `src/app/api/upload/route.ts` - new endpoint","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-02T21:10:18.777852347Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.873586766Z","closed_at":"2026-01-03T00:33:22.61070872Z","close_reason":"Closed"}
{"id":"mt-x9b","title":"Set up backend environment and secrets","description":"Blocking setup work BEFORE implementation begins:\n\n1. Create Langfuse account at cloud.langfuse.com, get API keys\n2. Verify Supermemory API access - test write/search with curl\n3. Verify Supabase project access with service role key\n4. Create Vercel project, configure all env vars:\n   - SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY\n   - SUPERMEMORY_API_KEY\n   - NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY, CLERK_SECRET_KEY\n   - LANGFUSE_PUBLIC_KEY, LANGFUSE_SECRET_KEY, LANGFUSE_HOST\n   - NEXT_PUBLIC_POSTHOG_KEY, POSTHOG_HOST\n   - ANTHROPIC_API_KEY\n5. Document any API quirks or gotchas discovered\n\nThis unblocks all implementation issues. Do this first.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-02T08:52:59.304216092Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.691856916Z","closed_at":"2026-01-02T09:16:37.050410112Z"}
{"id":"mt-xve","title":"Phase 1.2: Verify apps work","description":"Test web (pnpm install \u0026\u0026 pnpm build) and API (uv sync \u0026\u0026 uv run python start_server.py) to confirm they run in new locations","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-01T17:02:55.145456-08:00","created_by":"elijah","updated_at":"2026-01-04T05:09:26.759192479Z","closed_at":"2026-01-01T17:38:35.417959-08:00","close_reason":"Closed"}
{"id":"mt-yfp","title":"Initialize session on app load","description":"Create backend session when user first lands and persist sessionId.\n\n**Current state:**\n- No session creation call\n- UserContext only uses localStorage\n- No sessionId for API calls\n\n**Implementation:**\n1. On app mount, check localStorage for existing sessionId\n2. If exists, validate with `GET /api/session/[id]`\n   - If valid: use it, hydrate UserContext from response\n   - If 404: clear localStorage, create new session\n3. If no sessionId, call `POST /api/session` with `{ clerk_org_id }`\n4. Store sessionId in:\n   - React state (for current session)\n   - localStorage (for persistence across refreshes)\n5. Expose sessionId via UserContext or dedicated hook\n\n**Where to implement:**\nOption A: In `UserProvider` - keeps all state together\nOption B: New `useSession` hook - cleaner separation\n\n**Edge cases:**\n- User has old sessionId that was deleted → create new\n- User clears localStorage → create new\n- Clerk org changes → may need new session (TBD)\n\n**Files to modify:**\n- `src/context/UserContext.tsx` - add session management\n- `src/app/rafael-ai/page.tsx` - ensure provider wraps correctly\n\n**Note:** For MVP, hardcode `clerk_org_id`. Real multi-tenant support is separate work.","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-02T21:08:51.003026735Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.677897952Z","closed_at":"2026-01-02T21:38:02.195543476Z","close_reason":"Implemented in commit 887018a"}
{"id":"mt-ykh","title":"Move embed URLs to mentor config","description":"Checkout plan ID and Calendly URL are hardcoded in AIChat - should come from mentor config.\n\n**Current state:**\n- `AIChat.tsx:548`: `checkoutPlanId: 'plan_joNwbFAIES0hH'` hardcoded\n- `AIChat.tsx:582`: `calendlyUrl: 'https://calendly.com/brady-mentorfy/30min'` hardcoded\n- These are mentor-specific values that shouldn't be in component code\n\n**Changes needed:**\n1. Add to `src/data/rafael-ai/mentor.ts`:\n   ```typescript\n   whopPlanId: 'plan_joNwbFAIES0hH',\n   calendlyUrl: 'https://calendly.com/...',\n   ```\n2. Import mentor config where needed\n3. When AI or sales flow triggers checkout/booking, use config values\n\n**Note:** This is separate from removing DEMO_COMMANDS (mentorfy-mv6). Even after demo commands are removed, the real embed triggers will need these values from config.\n\n**Files to modify:**\n- `src/data/rafael-ai/mentor.ts`\n- Wherever checkout/booking embeds are triggered","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-02T21:10:40.025049243Z","created_by":"eli","updated_at":"2026-01-04T05:09:26.821776204Z","closed_at":"2026-01-03T00:18:01.269178072Z","close_reason":"Closed"}
{"id":"mt-zqe","title":"Add AUTH_CONFIG to rafael-ai config","description":"Add AUTH_CONFIG object to src/config/rafael-ai.ts with requireAuthAfterPhase setting. This controls which phase completion triggers the sign-in requirement. Default to phase 1. Setting to null disables auth requirement entirely.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T04:56:58.749820028Z","created_by":"eli","updated_at":"2026-01-04T06:56:41.407143926Z","closed_at":"2026-01-04T06:56:41.407143926Z","close_reason":"Closed","labels":["auth","config"]}
